<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로그인 - 게임 아이템 거래소</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/auth.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- 헤더 -->
    <header class="header">
        <a href="index.html" class="site-title">게임 아이템 거래소</a>
        <button class="menu-btn" onclick="toggleMenu()">☰</button>
    </header>
    
    <!-- 사이드 메뉴 -->
    <div class="side-menu">
        <button class="side-menu-close" onclick="closeMenu()">×</button>
        <a href="index.html" class="menu-item">홈</a>
        <a href="attendance.html" class="menu-item">출석체크</a>
        <a href="market.html" class="menu-item">거래소</a>
        <a href="profile.html" class="menu-item">프로필</a>
        <a href="community_board.html" class="menu-item">게시판</a>
        <a href="login.html" class="menu-item">로그인</a>
        <a href="register.html" class="menu-item">회원가입</a>
    </div>

    <!-- 로그인 컨테이너 -->
    <div class="login-container">
        <div class="login-form">
            <!-- 에러 메시지 -->
            <div id="errorMessage" class="alert alert-error" style="display: none;">
                <i class="fas fa-exclamation-circle"></i>
                <span>에러 메시지</span>
            </div>
            
            <!-- 성공 메시지 -->
            <div id="successMessage" class="alert alert-success" style="display: none;">
                <i class="fas fa-check-circle"></i>
                <span>성공 메시지</span>
            </div>
            
            <form action="#" method="post" id="loginForm">
                <div class="form-group">
                    <input type="text" 
                           id="username" 
                           name="username" 
                           placeholder="아이디 또는 전화번호" 
                           required 
                           class="form-control" />
                </div>
                
                <div class="form-group">
                    <input type="password" 
                           id="password" 
                           name="password" 
                           placeholder="비밀번호" 
                           required 
                           class="form-control" />
                </div>
                
                <div class="form-check">
                    <input type="checkbox" id="rememberMe" name="rememberMe" class="form-check-input">
                    <label for="rememberMe" class="form-check-label">로그인 상태 유지</label>
                </div>
                
                <div class="form-button">
                    <button type="submit" class="btn btn-login">로그인</button>
                </div>
            </form>
            
            <div class="login-links">
                <a href="find_password.html" class="login-link">비밀번호 찾기</a>
                <a href="find_id.html" class="login-link">아이디 찾기</a>
                <a href="register.html" class="login-link">회원가입</a>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/common.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 로그인 폼 제출 처리
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const username = document.getElementById('username').value;
                    const password = document.getElementById('password').value;
                    
                    // 로그인 버튼 비활성화 및 로딩 표시
                    const loginBtn = document.querySelector('.btn-login');
                    loginBtn.disabled = true;
                    loginBtn.textContent = '로그인 중...';
                    
                    // 서버에서 사용자 정보 확인 (현재는 로컬스토리지에서 처리)
                    const users = JSON.parse(localStorage.getItem('users')) || [];
                    const user = users.find(u => u.username === username && u.password === password);
                    
                    if (user) {
                        // 로그인 성공
                        loginSuccess(user);
                    } else {
                        // 로컬 스토리지에 없는 경우, 서버에 로그인 요청 (실제로는 서버 API 호출)
                        // 현재는 시뮬레이션만 함
                        checkServerLogin(username, password);
                    }
                });
            }
            
            // 사용자 로그인 성공 처리 함수
            function loginSuccess(user) {
                // 로그인 성공 메시지 표시
                const successMessage = document.getElementById('successMessage');
                successMessage.style.display = 'block';
                successMessage.querySelector('span').textContent = '로그인에 성공했습니다!';
                
                // 로그인 상태 저장 (로컬 스토리지와 세션 스토리지 모두 사용)
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('userNickname', user.nickname || user.username);
                localStorage.setItem('currentUser', JSON.stringify({
                    username: user.username,
                    nickname: user.nickname,
                    gender: user.gender
                }));
                
                // 세션 스토리지에도 로그인 정보 저장
                sessionStorage.setItem('currentUser', JSON.stringify({
                    username: user.username,
                    nickname: user.nickname,
                    gender: user.gender
                }));
                
                // 바로 홈으로 이동
                window.location.href = 'index.html';
            }
            
            // 서버 로그인 검증 함수 (현재는 시뮬레이션)
            function checkServerLogin(username, password) {
                // 실제로는 서버에 API 요청을 보내야 함
                console.log('서버에 로그인 요청:', username);
                
                // 로그인 버튼 원상복구
                const loginBtn = document.querySelector('.btn-login');
                loginBtn.disabled = false;
                loginBtn.textContent = '로그인';
                
                // 로그인 실패 메시지 표시
                const errorMessage = document.getElementById('errorMessage');
                errorMessage.style.display = 'block';
                errorMessage.querySelector('span').textContent = '아이디 또는 비밀번호가 일치하지 않습니다.';
            }
            
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
</body>
</html>

